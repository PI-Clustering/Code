<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://neo4j-documentation.github.io/developer-resources/language-guides/assets/css/main.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">
</head>

<body>
    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
    <script src="https://d3js.org/d3.v3.min.js" type="text/javascript"></script>

    <!-- End of plugins - start of UI code -->

    <div class="container">
        <div class="row">
            <div class="col">
            </div>
            <div class="col">
                <title>Neo4j Clustering Algos</title>
                <h1>It's not beautiful, but it works</h1>
                <!-- Read about sliders: https://jqueryui.com/slider/ -->
                <form action="/" id="searchForm">

                    <h3> Select a database </h3>
                    <select name="db-select" id="db-select">
                        <option selected="selected">LDBC</option>
                        <option>Covid-19</option>
                    </select>

                    <h3> Select size for initial clustering </h3>
                    <label for="amount">Initial cluster size (up to 10):</label>
                    <input type="text" id="amount" readonly style="border:0; color:#f6931f; font-weight:bold;">
                    <div id="cluster-slider"></div>

                    <h3> Submit query on a database... </h3>
                    <button id="submit" class="btn btn-default" type="submit">Submit</button>
                </form>
                <div id="result"></div>
            </div>
            <div class="col">
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(function () {

            $("#db-select").selectmenu();

            $("#cluster-slider").slider({
                range: "max",
                value: 3,
                min: 0,
                max: 10,
                step: 1,
                slide: function (event, ui) {
                    $("#amount").val(ui.value);
                }
            });
            $("#amount").val($("#cluster-slider").slider("value"));


            $("#searchForm").submit(function (event) {

                // Stop form from submitting normally
                event.preventDefault();

                // Get some values from elements on the page:
                var $form = $(this),
                    db_name = $("#db-select option:selected").text(),
                    clusters = $("#cluster-slider").slider("option", "value"),
                    url = $form.attr("action");

                // Send the data using post
                var posting = $.post(url, { db: db_name, clust: clusters }, null, "json");

                // Put the results in a div
                posting.done(function (data) {
                    var content = data.msg;
                    $("#result").empty().append(content);
                });
            });


            function run_stuff() {
                const db_name = $("#db-select").val()
                const clusters = $("#cluster-slider").slider("value")
                $.post("/run/" + encodeURIComponent(db_name),
                    function (data) {
                        alert(data.msg)
                    }, "json");
                return false;
            }

            // Bind run_stuff function to #run-algo button
            $("#run-algo").click(run_stuff);

        })
    </script>

</body>

</html>